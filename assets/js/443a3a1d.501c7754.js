"use strict";(self.webpackChunkkraken_ci_website=self.webpackChunkkraken_ci_website||[]).push([[5e3],{4137:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return k}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(n),k=a,m=d["".concat(s,".").concat(k)]||d[k]||c[k]||i;return n?r.createElement(m,l(l({ref:t},p),{},{components:n})):r.createElement(m,l({ref:t},p))}));function k(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var u=2;u<i;u++)l[u]=n[u];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9679:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return s},default:function(){return k},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return c}});var r=n(3117),a=n(102),i=(n(7294),n(4137)),l=["components"],o={id:"dev-guide",title:"Development Guide"},s=void 0,u={unversionedId:"dev-guide",id:"dev-guide",title:"Development Guide",description:"Development Depencies",source:"@site/docs/dev-guide.md",sourceDirName:".",slug:"/dev-guide",permalink:"/docs/dev-guide",draft:!1,editUrl:"https://github.com/kraken-ci/website/edit/master/docs/dev-guide.md",tags:[],version:"current",frontMatter:{id:"dev-guide",title:"Development Guide"},sidebar:"someSidebar",previous:{title:"Contributing to Kraken",permalink:"/docs/contrib-kraken"},next:{title:"Contributing to Documentation",permalink:"/docs/contrib-docs"}},p={},c=[{value:"Development Depencies",id:"development-depencies",level:2},{value:"Ubuntu 20.04",id:"ubuntu-2004",level:3},{value:"Download Sources",id:"download-sources",level:2},{value:"Start in Docker Compose",id:"start-in-docker-compose",level:2},{value:"Start Services Individually",id:"start-services-individually",level:2}],d={toc:c};function k(e){var t=e.components,o=(0,a.Z)(e,l);return(0,i.kt)("wrapper",(0,r.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"development-depencies"},"Development Depencies"),(0,i.kt)("h3",{id:"ubuntu-2004"},"Ubuntu 20.04"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"git"),(0,i.kt)("li",{parentName:"ul"},"rake"),(0,i.kt)("li",{parentName:"ul"},"python3-venv"),(0,i.kt)("li",{parentName:"ul"},"python3-pip"),(0,i.kt)("li",{parentName:"ul"},"openjdk-11-jre-headless or newer -- required for swagger-codegen"),(0,i.kt)("li",{parentName:"ul"},"docker.io"),(0,i.kt)("li",{parentName:"ul"},"docker-compose")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ sudo apt update\n$ sudo apt install git rake python3-venv python3-pip openjdk-11-jre-headless \\\n   docker.io docker-compose\n")),(0,i.kt)("h2",{id:"download-sources"},"Download Sources"),(0,i.kt)("p",null,"Sources are stored in Git repository on GitHub: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/Kraken-CI/kraken"},"https://github.com/Kraken-CI/kraken"),".\nFirst start with forking the repository and then cloning your own copy of it."),(0,i.kt)("p",null,"To clone repository via HTTPS do:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ git clone https://github.com/<username>/kraken\n\n")),(0,i.kt)("p",null,"or using SSH:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ git clone git@github.com:<username>/kraken.git\n")),(0,i.kt)("h2",{id:"start-in-docker-compose"},"Start in Docker Compose"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ cd kraken\n$ rake docker_up\n")),(0,i.kt)("p",null,"This command is using docker-compose.yaml file from the repository.\nThis file defines all the services and how to build them.\nSo this command builds all services and then spins up their containers."),(0,i.kt)("p",null,"Now Kraken service is avaiable from ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:8080"},"http://localhost:8080"),"."),(0,i.kt)("p",null,"All containers can be stopped by ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl-C"),". You may use this method for\ndevelopment. Prepare changes, then ",(0,i.kt)("inlineCode",{parentName:"p"},"rake docker_up"),", check changes\nif all is ok and then stop all with ",(0,i.kt)("inlineCode",{parentName:"p"},"Ctrl-C"),"."),(0,i.kt)("p",null,"This method is not that convenient for quick development. Building\nand starting all services from scratch takes several minutes.\nThere is a better method"),(0,i.kt)("h2",{id:"start-services-individually"},"Start Services Individually"),(0,i.kt)("p",null,"Each Kraken service can be run individually. There is a bunch of Rake\ntasks for that:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake serve_ui")," - start Kraken Angular app"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_server")," - start Kraken web server"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_scheduler")," - start Kraken scheduler service"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_planner")," - start Kraken planner service"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_watchdog")," - start Kraken watchdog service"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_rq")," - start RQ with Kraken background tasks"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_qneck")," - start Queue Neck service for filtering background tasks"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_agent")," - start Kraken Agent service localy"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_agent_in_docker")," - start Kraken Agent service inside Docker container"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_agent_in_lxd")," - start Kraken Agent service inside LXD container"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_ch")," - start ClickHouse and ClickHouse-proxy services"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_minio")," - run MinIO service"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_redis")," - run Redis service"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"rake run_pgsql")," - run PostgreSQL service")),(0,i.kt)("p",null,"This way all needed services can be started and then developed and restarted individually."),(0,i.kt)("p",null,"To avoid running all of them manually, there is a script for ",(0,i.kt)("inlineCode",{parentName:"p"},"Tmux")," terminal that\nopens separate window for each service. So first start ",(0,i.kt)("inlineCode",{parentName:"p"},"tmux")," and then\nload Kraken script inside ",(0,i.kt)("inlineCode",{parentName:"p"},"tmux"),":"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"run ",(0,i.kt)("inlineCode",{parentName:"li"},"tmux")),(0,i.kt)("li",{parentName:"ol"},"press ",(0,i.kt)("inlineCode",{parentName:"li"},"ctrl-b + :")," -- to open tmux prompt"),(0,i.kt)("li",{parentName:"ol"},"type ",(0,i.kt)("inlineCode",{parentName:"li"},"source-file kraken.tmux"))),(0,i.kt)("p",null,"or directly in command line:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ tmux new-session \\; source-file kraken.tmux`\n")),(0,i.kt)("p",null,"or using a script in the repo:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-console"},"$ ./start-tmux.sh`\n")),(0,i.kt)("p",null,"The effect should look as follows:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Kraken in Tmux",src:n(3674).Z,width:"1920",height:"1049"})),(0,i.kt)("p",null,"Now we can connect directly to Kraken Angular application. It is available\non ",(0,i.kt)("a",{parentName:"p",href:"http://localhost:4200"},"http://localhost:4200"),"."))}k.isMDXComponent=!0},3674:function(e,t,n){t.Z=n.p+"assets/images/tmux-54d21ea69b4d24f9aa54ec0b207577c1.png"}}]);