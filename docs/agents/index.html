<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kraken CI Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kraken CI Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-152860048-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Kraken CI" href="/opensearch.xml"><title data-react-helmet="true">Agents | Kraken CI</title><meta data-react-helmet="true" property="og:url" content="https://kraken.ci/docs/agents"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Agents | Kraken CI"><meta data-react-helmet="true" name="description" content="Agent is a part of Kraken system. The place of agents in Kraken is"><meta data-react-helmet="true" property="og:description" content="Agent is a part of Kraken system. The place of agents in Kraken is"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kraken.ci/docs/agents"><link data-react-helmet="true" rel="alternate" href="https://kraken.ci/docs/agents" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kraken.ci/docs/agents" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.fb5058af.css">
<link rel="preload" href="/assets/js/runtime~main.5a03831c.js" as="script">
<link rel="preload" href="/assets/js/main.7fda8789.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Kraken CI</b></a><a class="navbar__item navbar__link" href="/docs/philosophy">Philosophy</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="http://lab.kraken.ci" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Demo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/docs/quick-start">Quick Start</a><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Discussion Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/docs/contrib-kraken">Contributing</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sponsors/godfryd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-sponsor-item"><span>Sponsor Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a class="navbar__item navbar__link" href="/support">Support</a><a class="navbar__item navbar__link" href="/contact">Contact</a><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Kraken CI</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/philosophy">Philosophy</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="http://lab.kraken.ci" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Demo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a class="menu__link" href="/docs/quick-start">Quick Start</a></li><li class="menu__list-item"><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Discussion Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a class="menu__link" href="/docs/contrib-kraken">Contributing</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/sponsors/godfryd" target="_blank" rel="noopener noreferrer" class="menu__link navbar-sponsor-item"><span>Sponsor Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a class="menu__link" href="/support">Support</a></li><li class="menu__list-item"><a class="menu__link" href="/contact">Contact</a></li><li class="menu__list-item"><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/quick-start">Quick Start</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/philosophy">Philosophy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/features">Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/demo">Demo</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/entities">Entities &amp; Terminology</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/architecture">Architecture</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Usage</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/proj-branches">Projects and Branches</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/stages">Stages in a Branch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema">Workflow Schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema-vars">Schema Variables</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tools">Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/secrets">Secrets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/webhooks">Webhooks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/docker-executor">Docker Executor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/lxd-executor">LXD Executor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/test-results">Test Results</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Administration</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/agents">Agents</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/storage">Global Storage</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/guide-intro">Introductory Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contributing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contrib-kraken">Contributing to Kraken</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/dev-guide">Development Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/contrib-docs">Contributing to Documentation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema-ref">Workflow Schema Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/server-api">Server API v1</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Agents</h1></header><p>Agent is a part of Kraken system. The place of agents in Kraken is
visualized in <a href="/docs/architecture">Architecture chapter</a>.</p><p>Agent is a piece of software that is installed on separate system.
It connects to Kraken server, gets jobs to execution and executes
them. A job can be executed in several ways. It depends on selected
executor indicated in job definition. A job may be executed:</p><ul><li>locally on current host system,</li><li>inside Docker container,</li><li>inside LXD container.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="browsing-agents"></a>Browsing Agents<a class="hash-link" href="#browsing-agents" title="Direct link to heading">#</a></h2><p>In the top bar of UI, on right side, there is an <code>Agents</code> menu.
It can be used to find and manage agents.</p><p>The first position, <code>Agents</code> allows for browsing active agents that can
execute jobs. The table of agents shows their address, current system
where they are running, if they are running on bare-metal host or in
Docker container, what capabilities host system has, currently running
job, etc.</p><img src="/img/screen-agents.png" style="box-shadow:0 10px 10px 5px #777;margin-bottom:30px"><p>Clicking the agent address leads to agent page which shows Agent
details. Here, it is also possible to assign an agent to <code>Agents
Groups</code>. These groups are used in job definitions in workflow schema
to indicate from which group an agent should be selected to execute
indicated job.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="agents-groups"></a>Agents Groups<a class="hash-link" href="#agents-groups" title="Direct link to heading">#</a></h2><p>The next menu position, <code>Groups</code>, allows for gathering agents
into groups. Grouping can be arbitrary and manually managed by
administrator. It can be by hardware features, host system
capabilities, etc.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="discovered-agents"></a>Discovered Agents<a class="hash-link" href="#discovered-agents" title="Direct link to heading">#</a></h2><p>The last menu position, <code>Discovered</code>, shows list of agents that tried
to connect to the Kraken server but are not authorized to do so. Here
we can find newly setup agent and athorize it. From that moment it can
execute jobs but first it is good to assign this new agent to proper
groups.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setting-up-a-new-agent"></a>Setting up a New Agent<a class="hash-link" href="#setting-up-a-new-agent" title="Direct link to heading">#</a></h2><p>There are several methods for setting up a new Kraken Agent. It can
be installed on a host system using a installation script. It can be
started as a Docker container. It is also possible to copy agent
binaries and setup it manually.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="network-connections"></a>Network Connections<a class="hash-link" href="#network-connections" title="Direct link to heading">#</a></h3><p>While setting up a new agent, network connections need to be
considered.  Kraken Agent needs to have connections to several
services. They are presented
in <a href="/docs/architecture">Architecture chapter</a>. The required services are:
<code>Kraken Server</code>, <code>MinIO</code> and <code>ClickHouse</code>.</p><p>The address of the server must be passed to agent binary using <code>-s</code>
switch. This is handled by install script or is already backed into
Docker image with Kraken Agent.</p><p>In that moment the address of MinIO and ClickHouse should be acquired
from the server. Unfortunatelly if Kraken Server is started by docker
compose then the addresses of these services are internal ie. from a
subnet that was created by docker compose. The services are published
to the host using defined ports in the docker compose yaml
configuration file. So when the Kraken Agent is started externally
then the addresses to MinIO and ClickHouse needs to be provided. This
can be done by defining environemnt variables:
<code>KRAKEN_CLICKHOUSE_ADDR</code> and <code>KRAKEN_MINIO_ADDR</code>. More details about
setting them is provided in the next sections.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="installing-by-a-script"></a>Installing by a Script<a class="hash-link" href="#installing-by-a-script" title="Direct link to heading">#</a></h3><p>This method relies on an install script that is hosted on Kraken server.</p><p>Make sure that in Kraken Web UI, on Kraken -&gt; Settings page there is
URL to Kraken Server set (copy and paste URL from web browser to this
field).</p><p>So now a new Agent can be installed. It involves downloading an agent
installer and running it. That&#x27;s all.</p><p>Agent Install steps:</p><ol><li>Download Kraken agent installer:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly console"><pre tabindex="0" class="prism-code language-console codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ wget http://&lt;kraken-server-address&gt;/install/kraken-agent-install.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>Execute installer:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly console"><pre tabindex="0" class="prism-code language-console codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ chmod a+x kraken-agent-install.sh</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ ./kraken-agent-install.sh</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This will download the latest agent from Kraken server and install it
as a SystemD service on the host. Agent&#x27;s files are installed into
<code>/opt/kraken</code> directory. The state of the service can be checked using
<code>systemctl</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly console"><pre tabindex="0" class="prism-code language-console codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo systemctl status kraken-agent</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">● kraken-agent.service - Kraken Agent</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Loaded: loaded (/lib/systemd/system/kraken-agent.service; enabled; vendor preset: enabled)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Active: active (running) since Thu 2021-03-11 17:09:16 UTC; 1 weeks 0 days ago</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> Main PID: 699 (python3)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Tasks: 1 (limit: 6998)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   Memory: 14.5M</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   CGroup: /system.slice/kraken-agent.service</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">           └─699 python3 /opt/kraken/kkagent -s http://localhost:6000/ -d /opt/kraken/data run</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The Kraken Agent service is running but it may not see <code>MinIO</code> and
<code>ClickHouse</code> services. This can be configured in
<code>/opt/kraken/kraken.env</code> file.</p><p>Set <code>KRAKEN_CLICKHOUSE_ADDR</code> to the host where <code>clickhouse-proxy</code> is
running and add its listening port. If Kraken Server is started by
docker compose then use the address of the host. The port to
<code>clickhouse-proxy</code> should be taken from .env file or from docker
compose yaml file. Example:
<code>KRAKEN_CLICKHOUSE_ADDR=192.168.0.12:9001</code>.</p><p>Set <code>KRAKEN_MINIO_ADDR</code> to the host where <code>minio</code> is running and add
its listening port. If Kraken Server is started by docker compose then
use the address of the host. The port to <code>minio</code> should be
taken from .env file or from docker compose yaml file. Example:
<code>KRAKEN_MINIO_ADDR=192.168.0.12:9999</code>.</p><p>If Kraken Server was started by docker compose then the ports of these
services can be determined using <code>docker ps</code>. Example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly console"><pre tabindex="0" class="prism-code language-console codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker ps | grep &#x27;chproxy\|minio&#x27;</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">c17deb0b8fb7   127.0.0.1:5000/kkchproxy:kk_ver           ....  0.0.0.0:9001-&gt;9001/udp            kraken_clickhouse-proxy_1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">b3e7c3aeeeb3   minio/minio:RELEASE.2020-12-18T03-27-42Z  ....  9000/tcp, 0.0.0.0:9999-&gt;9999/tcp  kraken_minio_1</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>where we can see that <code>clickhouse proxy</code> is exposed on 9001 port and
<code>minio</code> on 9999.</p><p>Now the new agent can be authorized in Kraken server. On Discovered
agents page there should be visible an IP address of the host with the
new agent. Select checkbox and click <code>Authorize</code> button. And then add
the agent to proper agent&#x27;s group. Now the new agent will be getting
jobs for execution.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="starting-in-docker-container"></a>Starting in Docker Container<a class="hash-link" href="#starting-in-docker-container" title="Direct link to heading">#</a></h3><p>In this case Kraken Agent is packed into Docker image and can be
started as Docker container.</p><p>The command to start a container is as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly console"><pre tabindex="0" class="prism-code language-console codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ docker run -e KRAKEN_SERVER_ADDR=&lt;host-addr&gt;:6363 \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             -e KRAKEN_CLICKHOUSE_ADDR=&lt;host-addr&gt;:9001 \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             -e KRAKEN_MINIO_ADDR=&lt;host-addr&gt;:9999 \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             --rm \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">             eu.gcr.io/kraken-261806/kkagent:&lt;version&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>where <code>&lt;host-addr&gt;</code> is a host address where given service is running.
If Kraken Server was started by <code>docker-compose</code> then the
<code>&lt;host-addr&gt;</code> is an address of the host where docker-compose has been
started. The ports above are default ports if the ports where changed
e.g. in docker compose .env file then the same ones should be used
here.</p><p><code>eu.gcr.io/kraken-261806/kkagent:&lt;version&gt;</code> is a location of Docker
image with Kraken Agent. The <code>&lt;version&gt;</code> identifies particular Kraken
version. The latest Kraken <code>&lt;version&gt;</code> can be found on a Kraken&#x27;s
releases page in GitHub: <a href="https://github.com/Kraken-CI/kraken/releases" target="_blank" rel="noopener noreferrer">https://github.com/Kraken-CI/kraken/releases</a>.
Example image URL: <code>eu.gcr.io/kraken-261806/kkagent:0.406</code>.  Notice
that the version in the image URL does not have <code>v</code> prefix as on
GitHub page (v0.406).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/kraken-ci/website/edit/master/docs/agents.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/test-results"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Test Results</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/storage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Global Storage »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#browsing-agents" class="table-of-contents__link">Browsing Agents</a></li><li><a href="#agents-groups" class="table-of-contents__link">Agents Groups</a></li><li><a href="#discovered-agents" class="table-of-contents__link">Discovered Agents</a></li><li><a href="#setting-up-a-new-agent" class="table-of-contents__link">Setting up a New Agent</a><ul><li><a href="#network-connections" class="table-of-contents__link">Network Connections</a></li><li><a href="#installing-by-a-script" class="table-of-contents__link">Installing by a Script</a></li><li><a href="#starting-in-docker-container" class="table-of-contents__link">Starting in Docker Container</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation/">Installation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discussion Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Business</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/contact">Contact</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 <a href="mailto:mike@kraken.ci">Michal Nowikowski</a>. Built with Docusaurus. Icons made by <a href="https://www.flaticon.com/authors/freepik">Freepik</a> from <a href="https://www.flaticon.com">flaticon</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.5a03831c.js"></script>
<script src="/assets/js/main.7fda8789.js"></script>
</body>
</html>