<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-install-manual">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Manual Installation | Kraken CI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kraken.ci/docs/install-manual"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Manual Installation | Kraken CI"><meta data-rh="true" name="description" content="The installation is based on Ubuntu 22.04. All instructions and"><meta data-rh="true" property="og:description" content="The installation is based on Ubuntu 22.04. All instructions and"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kraken.ci/docs/install-manual"><link data-rh="true" rel="alternate" href="https://kraken.ci/docs/install-manual" hreflang="en"><link data-rh="true" rel="alternate" href="https://kraken.ci/docs/install-manual" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YHIPSVOLK3-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kraken CI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kraken CI Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-152860048-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-152860048-1",{anonymize_ip:!0})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Kraken CI" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.06f023a2.css">
<link rel="preload" href="/assets/js/runtime~main.34bc126b.js" as="script">
<link rel="preload" href="/assets/js/main.9f9a3be8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Kraken CI</b></a><a class="navbar__item navbar__link" href="/docs/philosophy">Philosophy</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="http://lab.kraken.ci" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Demo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/docs/quick-start">Quick Start</a><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discussion Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/docs/contrib-kraken">Contributing</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sponsors/godfryd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-sponsor-item">Sponsor Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/support">Support</a><a class="navbar__item navbar__link" href="/contact">Contact</a><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Kraken-CI/kraken/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Download<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/">Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/philosophy">Philosophy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/features">Features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/demo">Demo</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/install-docker-compose">Installation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/install-docker-compose">Docker Compose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/install-helm">Helm and Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/install-manual">Manual Installation</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/entities">Entities &amp; Terminology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture">Architecture</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/proj-branches">Usage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tf-junit">Testing Frameworks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/agents">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/guide-intro">Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/contrib-kraken">Contributing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/schema-ref">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Introduction</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Installation</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Manual Installation</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Manual Installation</h1></header><p>The installation is based on Ubuntu 22.04. All instructions and
commands should be performed in Ubuntu 22.04 system.</p><p>The first part of the manual shows how to install and prepare services
required by Kraken CI. The second part guides through the installation
of particular components of Kraken CI.</p><p>Manual installation requires better knowledge of Kraken CI
internals. So, first, get familiar
with <a href="/docs/architecture">Kraken CI architecture</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="required-3rd-party-services">Required 3rd Party Services<a class="hash-link" href="#required-3rd-party-services" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql">PostgreSQL<a class="hash-link" href="#postgresql" title="Direct link to heading">​</a></h3><p>Kraken relies on PostgreSQL 11.
The installation instruction can be found at <a href="https://www.postgresql.org/download/linux/ubuntu/" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/download/linux/ubuntu/</a>.</p><p>To install the required 11 version, do the following:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">apt</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">install</span><span class="token command bash language-bash"> postgresql-11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After installation, create a <code>kkdb</code> database for Kraken CI Server and a
user <code>kkuser</code> with <code>kkpass</code> password:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> -u postgres psql</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">postgres=# create database kkdb;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgres=# create user kkuser with encrypted password &#x27;kkpass&#x27;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgres=# grant all privileges on database kkdb to kkuser;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="redis">Redis<a class="hash-link" href="#redis" title="Direct link to heading">​</a></h3><p>Kraken is using Redis and is tested with the 7.0 version.
The installation instruction can be found at <a href="https://redis.io/docs/getting-started/installation/install-redis-on-linux/" target="_blank" rel="noopener noreferrer">https://redis.io/docs/getting-started/installation/install-redis-on-linux/</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clickhouse">Clickhouse<a class="hash-link" href="#clickhouse" title="Direct link to heading">​</a></h3><p>Kraken is using Clickhouse and is tested with the 22.10.2.11 version.
The installation instruction can be found at <a href="https://clickhouse.com/docs/en/install/#install-from-deb-packages" target="_blank" rel="noopener noreferrer">https://clickhouse.com/docs/en/install/#install-from-deb-packages</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minio">MinIO<a class="hash-link" href="#minio" title="Direct link to heading">​</a></h3><p>RELEASE.2022-10-24T18-35-07Z</p><p>Kraken is using MinIO RELEASE.2022-10-24T18-35-07Z version. Newer
versions may not work, so please use indicated version. The
installation instruction can be found at
<a href="https://min.io/docs/minio/linux/operations/installation.html" target="_blank" rel="noopener noreferrer">https://min.io/docs/minio/linux/operations/installation.html</a>.</p><p>Debian package can be downloaded from here:
<a href="https://dl.min.io/server/minio/release/linux-amd64/archive/minio_20221024183507.0.0_amd64.deb" target="_blank" rel="noopener noreferrer">https://dl.min.io/server/minio/release/linux-amd64/archive/minio_20221024183507.0.0_amd64.deb</a>.
RPM from here:
<a href="https://dl.min.io/server/minio/release/linux-amd64/archive/minio-20221024183507.0.0.x86_64.rpm" target="_blank" rel="noopener noreferrer">https://dl.min.io/server/minio/release/linux-amd64/archive/minio-20221024183507.0.0.x86_64.rpm</a>.
Please check for any other format on this page:
<a href="https://dl.min.io/server/minio/release/linux-amd64/archive/" target="_blank" rel="noopener noreferrer">https://dl.min.io/server/minio/release/linux-amd64/archive/</a>.</p><p>The configuration could be set up in <code>/etc/default/minio</code> file. There should be set at least the following fields:</p><ul><li><code>MINIO_ROOT_USER</code> - a name for the root user; this needs to be
passed to Kraken components later (especially Kraken Server);</li><li><code>MINIO_ROOT_PASSWORD</code> - a password for the root user; this needs to
be passed to Kraken components later (especially Kraken Server);</li><li><code>MINIO_VOLUMES</code> - it must point to a folder where MinIO data will be
stored;</li><li><code>MINIO_OPTS</code> - this should be used at least to change the listening
port - see next paragraph.</li></ul><p>Unfortunately, Clickhouse and MinIO are listening on the same TCP
port 9000.  It can be changed in MinIO in <code>/etc/default/minio</code> by
adding the following line:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">MINIO_OPTS=--address :9999</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx-as-a-reverse-proxy">Nginx as a reverse proxy<a class="hash-link" href="#nginx-as-a-reverse-proxy" title="Direct link to heading">​</a></h3><p>As a frontend web server that does reverse proxy, any web server can be
used, for example, Nginx.</p><p>First, install Nginx:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">apt</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">install</span><span class="token command bash language-bash"> nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The configuration will be described in <code>Web UI &amp; Reverse Proxy</code> section below.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kraken-components-installation">Kraken Components Installation<a class="hash-link" href="#kraken-components-installation" title="Direct link to heading">​</a></h2><p>Kraken CI components can be downloaded from Kraken
CI <a href="https://github.com/Kraken-CI/kraken/releases" target="_blank" rel="noopener noreferrer">GitHub releases</a>
page. There should be:</p><ul><li><code>clickhouse-proxy-VERSION.tar.gz</code></li><li><code>krakenci_server-VERSION.tar.gz</code></li><li><code>krakenci_ui-VERSION.tar.gz</code></li><li><code>krakenci_agent-VERSION.tar.gz</code></li></ul><p>where <code>VERSION</code> is for example <code>0.1091</code>.</p><p>Python packages can also be installed using <code>pip</code> tool.
For that purpose, a Python virtual env may be created:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">python3 -m venv venv</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">./venv/bin/pip </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">install</span><span class="token command bash language-bash"> -U pip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---clickhouse-proxy">Server - Clickhouse Proxy<a class="hash-link" href="#server---clickhouse-proxy" title="Direct link to heading">​</a></h3><p>Unpack <code>clickhouse-proxy</code>:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">tar</span><span class="token command bash language-bash"> -zxvf clickhouse-proxy-VERSION.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Prepare environment variables, ie. location of Clickhouse server:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash assign-left variable" style="color:rgb(191, 199, 213)">KRAKEN_CLICKHOUSE_URL</span><span class="token command bash language-bash operator" style="color:rgb(137, 221, 255)">=</span><span class="token command bash language-bash">http://localhost:8123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Start the proxy:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">./clickhouse-proxy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">started clickhouse proxy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Clickhouse address: &quot;http://localhost:8123&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">VersionRow { version: 2 }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">logs table created in clickhouse</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">waiting for logs to store</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---backend">Server - Backend<a class="hash-link" href="#server---backend" title="Direct link to heading">​</a></h3><p>There are prerequisites needed to install the Kraken CI server. It
depends on <code>python-ldap</code>, which has extensions in C language. So to
install and build Kraken CI dependencies there are needed:</p><ul><li>C compiler -- <code>gcc</code></li><li>headers for LDAP library -- <code>libldap-dev</code> and <code>libsasl2-dev</code></li><li>headers for Python -- <code>python3-dev</code></li></ul><p>They can be installed this way:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">apt</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">install</span><span class="token command bash language-bash"> gcc python3-dev libldap-dev libsasl2-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we are ready to install the Kraken CI Server component:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">./venv/bin/pip </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">install</span><span class="token command bash language-bash"> krakenci_server-VERSION.tar.gz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">Processing ./krakenci_server-0.1091.tar.gz</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">  Preparing metadata (setup.py) ... done</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Collecting Authlib&lt;2.0.0,&gt;=1.1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">  Downloading Authlib-1.1.0-py2.py3-none-any.whl (214 kB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---database-preparation">Server - Database Preparation<a class="hash-link" href="#server---database-preparation" title="Direct link to heading">​</a></h3><p>Run a script that sets up tables and performs database migration:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash assign-left variable" style="color:rgb(191, 199, 213)">KRAKEN_DB_URL</span><span class="token command bash language-bash operator" style="color:rgb(137, 221, 255)">=</span><span class="token command bash language-bash">postgresql://kkuser:kkpass@localhost:5432/kkdb ./venv/bin/kkdbmigrate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">Kraken DB Migration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">migrating db: postgresql://kkuser:kkpass@localhost:5432/kkdb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">checking TCP service postgresql on localhost:5432... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgresql is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">INFO  [alembic.runtime.migration] Will assume transactional DDL.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">INFO  [alembic.runtime.migration] Running stamp_revision  -&gt; 5c16623f4d55</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">alembic stamp completed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Preparing initial DB data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record local_tool</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record git</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record shell</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record pytest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record rndtest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record artifacts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record pylint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record cloc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record nglint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record cache</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record gotest</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record junit_collect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Tool record values_collect</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created AgentsGroup record &#x27;all&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Project record &#x27;Demo&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Branch record &#x27;master&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created Stage record &#x27;Tests&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created User record &#x27;admin&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   created User record &#x27;demo&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">DB version: 5c16623f4d55</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Kraken DB Migration completed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---planner">Server - Planner<a class="hash-link" href="#server---planner" title="Direct link to heading">​</a></h3><p>To start Kraken Planner, invoke the following command:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash assign-left variable" style="color:rgb(191, 199, 213)">KRAKEN_DB_URL</span><span class="token command bash language-bash operator" style="color:rgb(137, 221, 255)">=</span><span class="token command bash language-bash">postgresql://kkuser:kkpass@localhost:5432/kkdb ./venv/bin/kkplanner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">checking TCP service postgresql on localhost:5432... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgresql is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 05:59:36,533 INFO p: 2787     logs:409   setup logging on planner to clickhouse: localhost:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 05:59:36,533 INFO p: 2787  planner:161   Kraken Planner started, version 0.1091</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 05:59:36,720 INFO p: 2787     base:171   Scheduler started</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 05:59:36,723 INFO p: 2787  planner:43    started planner scheduler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 05:59:36,732 INFO p: 2787  planner:172   starting xml-rpc server for planner on port 7997</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other environment variables that could be expected by the Kraken Planner are:</p><ul><li><code>KRAKEN_PLANNER_URL</code> - the default is <code>http://localhost:7997</code></li><li><code>KRAKEN_CLICKHOUSE_ADDR</code> - the default is <code>http://localhost:8123</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---rq">Server - RQ<a class="hash-link" href="#server---rq" title="Direct link to heading">​</a></h3><p>To start Kraken RQ, invoke the following command:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash assign-left variable" style="color:rgb(191, 199, 213)">KRAKEN_DB_URL</span><span class="token command bash language-bash operator" style="color:rgb(137, 221, 255)">=</span><span class="token command bash language-bash">postgresql://kkuser:kkpass@localhost:5432/kkdb ./venv/bin/kkrq</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">checking TCP service planner on localhost:7997... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">planner is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">checking TCP service redis on localhost:6379... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">redis is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">checking TCP service postgresql on localhost:5432... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgresql is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,132 INFO p: 2809     logs:409   setup logging on rq to clickhouse: localhost:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,133 INFO p: 2809     kkrq:105   Kraken RQ started, version 0.1091</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,297 INFO p: 2809   worker:569   Worker rq:worker:76715862411a4038b99ff404aeedb5b4: started, version 1.11.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,299 INFO p: 2809   worker:539   Subscribing to channel rq:pubsub:76715862411a4038b99ff404aeedb5b4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,303 INFO p: 2809   worker:573   *** Listening on kq...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,304 INFO p: 2809 schedule:107   Trying to acquire locks for kq</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,312 INFO p: 2813 schedule:233   Scheduler for kq started with PID 2813</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:02:36,313 INFO p: 2809   worker:1187  Cleaning registries for queue: kq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other environment variables that could be expected by the Kraken RQ are:</p><ul><li><code>KRAKEN_PLANNER_URL</code> - the default is <code>http://localhost:7997</code></li><li><code>KRAKEN_CLICKHOUSE_ADDR</code> - the default is <code>http://localhost:8123</code></li><li><code>KRAKEN_REDIS_ADDR</code> - the default is <code>localhost:6379</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---qneck">Server - QNeck<a class="hash-link" href="#server---qneck" title="Direct link to heading">​</a></h3><p>To start Kraken QNeck, invoke the following command:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">./venv/bin/kkqneck</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">2022-12-05 06:03:07,656 INFO p: 2824     logs:409   setup logging on rq to clickhouse: localhost:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:03:07,657 INFO p: 2824    qneck:136   Kraken QNeck started, version 0.1091</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">checking TCP service redis on localhost:6379... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">redis is up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other environment variables that could be expected by the Kraken QNeck are:</p><ul><li><code>KRAKEN_CLICKHOUSE_ADDR</code> - the default is <code>http://localhost:8123</code></li><li><code>KRAKEN_REDIS_ADDR</code> - the default is <code>localhost:6379</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---scheduler">Server - Scheduler<a class="hash-link" href="#server---scheduler" title="Direct link to heading">​</a></h3><p>To start Kraken Scheduler, invoke the following command:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash assign-left variable" style="color:rgb(191, 199, 213)">KRAKEN_DB_URL</span><span class="token command bash language-bash operator" style="color:rgb(137, 221, 255)">=</span><span class="token command bash language-bash">postgresql://kkuser:kkpass@localhost:5432/kkdb ./venv/bin/kkscheduler</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">checking TCP service postgresql on localhost:5432... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgresql is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">checking TCP service planner on localhost:7997... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">planner is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:13,445 INFO p: 2942     logs:409   setup logging on scheduler to clickhouse: localhost:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:13,446 INFO p: 2942 schedule:139   Kraken Scheduler started, version 0.1091</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:13,621 INFO p: 2942 schedule:117   no idle agents</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:13,621 INFO p: 2942 schedule:173   scheduled 0 jobs in 0.0s, go sleep for 5.0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:18,620 INFO p: 2942 schedule:117   no idle agents</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other environment variables that could be expected by the Kraken Scheduler are:</p><ul><li><code>KRAKEN_CLICKHOUSE_ADDR</code> - the default is <code>http://localhost:8123</code></li><li><code>KRAKEN_PLANNER_URL</code> - the default is <code>http://localhost:7997</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---watchdog">Server - Watchdog<a class="hash-link" href="#server---watchdog" title="Direct link to heading">​</a></h3><p>To start Kraken Watchdog, invoke the following command:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash assign-left variable" style="color:rgb(191, 199, 213)">KRAKEN_DB_URL</span><span class="token command bash language-bash operator" style="color:rgb(137, 221, 255)">=</span><span class="token command bash language-bash">postgresql://kkuser:kkpass@localhost:5432/kkdb ./venv/bin/kkwatchdog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">checking TCP service postgresql on localhost:5432... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">postgresql is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">checking TCP service planner on localhost:7997... 1.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">planner is up</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:53,819 INFO p: 3003     logs:409   setup logging on watchdog to clickhouse: localhost:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-05 06:40:53,820 INFO p: 3003 watchdog:53    Kraken Watchdog started, version 0.1091</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other environment variables that could be expected by the Kraken Watchdog are:</p><ul><li><code>KRAKEN_CLICKHOUSE_ADDR</code> - the default is <code>http://localhost:8123</code></li><li><code>KRAKEN_PLANNER_URL</code> - the default is <code>http://localhost:7997</code></li><li><code>KRAKEN_REDIS_ADDR</code> - the default is <code>localhost:6379</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="server---server">Server - Server<a class="hash-link" href="#server---server" title="Direct link to heading">​</a></h3><p>Set required environment variables:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token output">export KRAKEN_DB_URL=postgresql://kkuser:kkpass@localhost:5432/kkdb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">export MINIO_ROOT_USER=root</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">export MINIO_ROOT_PASSWORD=password</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">export KKAGENT_DIR=/usr/share/nginx/html/agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then start the server directly:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token output">./venv/bin/python3 -m kraken.server.server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>or using <code>gunicorn</code>:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token output">./venv/bin/gunicorn -b 0.0.0.0:8080 -w 2 &quot;kraken.server.server:create_app()&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Other environment variables that could be expected by the Kraken Server are:</p><ul><li><code>KRAKEN_CLICKHOUSE_ADDR</code> - the default is <code>http://localhost:8123</code></li><li><code>KRAKEN_PLANNER_URL</code> - the default is <code>http://localhost:7997</code></li><li><code>KRAKEN_REDIS_ADDR</code> - the default is <code>localhost:6379</code></li><li><code>KRAKEN_SERVER_ADDR</code> - the default is <code>localhost:8080</code></li><li><code>KRAKEN_MINIO_ADDR</code> - the default is <code>localhost:9999</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="web-ui--reverse-proxy">Web UI &amp; Reverse Proxy<a class="hash-link" href="#web-ui--reverse-proxy" title="Direct link to heading">​</a></h3><p>Save the following nginx.conf file in <code>/etc/nginx/sites-available/kraken</code>:</p><div class="language-apache codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-apache codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">upstream ui_rest {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server localhost:8080;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    listen       80;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server_name  localhost;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    root   /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    index  index.html index.htm;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    location ~ ^/(bk|api|webhooks|artifacts|job_log|install|backend|branch-badge) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_pass http://ui_rest;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_buffering off;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        proxy_set_header Accept-Encoding &quot;&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try_files $uri $uri/ /index.html;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # redirect server error pages to the static page /50x.html</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    error_page   500 502 503 504  /50x.html;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    location = /50x.html {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        root   /usr/share/nginx/html;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The critical part is:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    server localhost:8080;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It indicates the serving address and port of the backend Kraken CI server.
It should point to <code>KRAKEN_SERVER_ADDR</code>, which is <code>localhost:8080</code> by default.</p><p>Unpack static Kraken Web UI content:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token output">tar -zxvf krakenci_ui-VERSION.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Copy this static content to <code>/usr/share/nginx/html</code>:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">cp</span><span class="token command bash language-bash"> -a krakenci_ui-VERSION/* /usr/share/nginx/html</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now remove the default site in Nginx and add the kraken site:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">rm</span><span class="token command bash language-bash"> /etc/nginx/sites-enabled/default</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">ln</span><span class="token command bash language-bash"> -s /etc/nginx/sites-available/kraken /etc/nginx/sites-enabled/kraken</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now restart and check the Nginx service:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> systemctl restart nginx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> systemctl status nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now you may check if Kraken web UI is working by visiting
<a href="http://localhost/" target="_blank" rel="noopener noreferrer">http://localhost/</a> in your web browser or using curl:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">curl</span><span class="token command bash language-bash"> http://localhost/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In a web browser, log in with <code>admin</code>:<code>admin</code> credentials.  Next, go to
<code>Configuration</code>-&gt;<code>Settings</code> page and on <code>General</code> tab set <code>Kraken
Server URL</code>, <code>MinIO Address</code> and <code>Clickhouse Proxy Address</code>. And then
click the save button at the bottom.</p><p>Now you can install Kraken Agent.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="agent">Agent<a class="hash-link" href="#agent" title="Direct link to heading">​</a></h3><p>Unpack <code>krakenci_agent-VERSION.tar.gz</code> and copy
<code>krakenci_agent-VERSION/kkagent</code> and <code>krakenci_agent-0.1091/kktool</code> to
<code>KKAGENT_DIR</code> i.e. <code>/usr/share/nginx/html/agent</code>:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">tar</span><span class="token command bash language-bash"> -zxvf krakenci_agent-VERSION.tar.gz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token command bash language-bash"> -p /usr/share/nginx/html/agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">cp</span><span class="token command bash language-bash"> -a krakenci_agent-VERSION/* /usr/share/nginx/html/agent/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In Kraken Web UI, go to <code>Agents</code> menu and click <code>Download</code>. This will
download a script for installing <code>Kraken Agent</code>.</p><p>Transfer it to a machine where you want to have Kraken Agent running
and then run:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">chmod</span><span class="token command bash language-bash"> a+x kraken-agent-install.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">./kraken-agent-install.sh</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token output">+ KRAKEN_URL=http://10.79.46.85</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ sudo -n true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ &#x27;[&#x27; 0 -ne 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ python3 --version</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Python 3.10.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ &#x27;[&#x27; 0 -ne 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ DL_TOOL=</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ which curl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">/usr/bin/curl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ &#x27;[&#x27; 0 -ne 0 &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ DL_TOOL=curl</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ set -e</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ &#x27;[&#x27; curl == wget &#x27;]&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ curl -o /tmp/kkagent http://10.79.46.85/install/agent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">                                 Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">100 1366k  100 1366k    0     0  70.1M      0 --:--:-- --:--:-- --:--:-- 74.1M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ chmod a+x /tmp/kkagent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ export KRAKEN_CLICKHOUSE_ADDR=10.79.46.85:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ KRAKEN_CLICKHOUSE_ADDR=10.79.46.85:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ /tmp/kkagent install -s http://10.79.46.85</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-06 05:11:29,897 INFO p: 4552     logs:409   setup logging on agent to clickhouse: 10.79.46.85:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-06 05:11:29,898 INFO p: 4552     main:49    Starting Kraken Agent, version 0.1091</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-06 05:11:29,899 INFO p: 4552     main:50    using Python version 3.10.6</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">2022-12-06 05:11:30,063 INFO p: 4552  install:107   no docker group</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Created symlink /etc/systemd/system/multi-user.target.wants/kraken-agent.service → /lib/systemd/system/kraken-agent.service.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">● kraken-agent.service - Kraken Agent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">     Loaded: loaded (/lib/systemd/system/kraken-agent.service; enabled; vendor preset: enabled)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">    Drop-In: /run/systemd/system/service.d</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">             └─zzz-lxc-service.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">     Active: active (running) since Tue 2022-12-06 05:11:30 UTC; 37ms ago</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">   Main PID: 4737 (python3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">      Tasks: 1 (limit: 14079)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">     Memory: 2.7M</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">        CPU: 27ms</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">     CGroup: /system.slice/kraken-agent.service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">             └─4737 python3 /opt/kraken/kkagent run</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Dec 06 05:11:30 u22 systemd[1]: Started Kraken Agent.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ rm -f /tmp/kkagent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">+ echo &#x27;Kraken Agent installed&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token output">Kraken Agent installed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can check logs of the installed agent by invoking:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token output">sudo journalctl -u kraken-agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In the logs, there should be seen a response with information that the
agent is unauthorized:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 06 05:12:41 u22 kkagent[4737]: 2022-12-06 05:12:41,974 INFO p: 4737    agent:137   RESP {&#x27;unauthorized&#x27;: True}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 06 05:12:41 u22 kkagent[4737]: 2022-12-06 05:12:41,975 WARN p: 4737    agent:140   agent is not authorized, sleeping for 10s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now go to Kraken web UI and go to <code>Agents</code>-&gt;<code>Discovered</code> menu. The
started agent should be present there. Select the checkbox on the left
and click <code>Authorize</code> button at the top.</p><p>Now switch the web page to the list of authorized agents:
<code>Agents</code>-&gt;<code>Agents</code>. Now the agent should be visible here and should be
enabled.</p><p>Recheck the agent logs:</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token output">sudo journalctl -u kraken-agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now it should be visible that the received job by the agent is empty:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 06 05:14:52 u22 kkagent[4737]: 2022-12-06 05:14:52,348 INFO p: 4737    agent:137   RESP {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 06 05:14:52 u22 kkagent[4737]: 2022-12-06 05:14:52,361 INFO p: 4737     logs:409   setup logging on agent to clickhouse: 10.79.46.85:9001</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dec 06 05:14:52 u22 kkagent[4737]: 2022-12-06 05:14:52,362 INFO p: 4737    agent:163   received job: {}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-first-job">The First Job<a class="hash-link" href="#the-first-job" title="Direct link to heading">​</a></h2><p>But first, install Git and Pytest on the machine where the Kraken Agent is
running. The demo job requires that.</p><div class="language-shellsession codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shellsession codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">sudo</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">apt</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">install</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash function" style="color:rgb(130, 170, 255)">git</span><span class="token command bash language-bash"> python3-pytest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, go to Krakek Web UI, go to the main page (click on the logo in
the left top corner), click <code>master</code> branch in <code>Project Demo</code> and now
click <code>Run Flow</code> button and then <code>Submit</code>. You should be on the <code>Flow
1.</code> page. In the big box, click <code>Tests</code> title (this is the name of the
job). This will land you on the Run page, where one job should be
visible in the pane on the left, while there should be logs in the
right pane.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/kraken-ci/website/edit/master/docs/install-manual.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/install-helm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Helm and Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/entities"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Entities &amp; Terminology</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#required-3rd-party-services" class="table-of-contents__link toc-highlight">Required 3rd Party Services</a><ul><li><a href="#postgresql" class="table-of-contents__link toc-highlight">PostgreSQL</a></li><li><a href="#redis" class="table-of-contents__link toc-highlight">Redis</a></li><li><a href="#clickhouse" class="table-of-contents__link toc-highlight">Clickhouse</a></li><li><a href="#minio" class="table-of-contents__link toc-highlight">MinIO</a></li><li><a href="#nginx-as-a-reverse-proxy" class="table-of-contents__link toc-highlight">Nginx as a reverse proxy</a></li></ul></li><li><a href="#kraken-components-installation" class="table-of-contents__link toc-highlight">Kraken Components Installation</a><ul><li><a href="#server---clickhouse-proxy" class="table-of-contents__link toc-highlight">Server - Clickhouse Proxy</a></li><li><a href="#server---backend" class="table-of-contents__link toc-highlight">Server - Backend</a></li><li><a href="#server---database-preparation" class="table-of-contents__link toc-highlight">Server - Database Preparation</a></li><li><a href="#server---planner" class="table-of-contents__link toc-highlight">Server - Planner</a></li><li><a href="#server---rq" class="table-of-contents__link toc-highlight">Server - RQ</a></li><li><a href="#server---qneck" class="table-of-contents__link toc-highlight">Server - QNeck</a></li><li><a href="#server---scheduler" class="table-of-contents__link toc-highlight">Server - Scheduler</a></li><li><a href="#server---watchdog" class="table-of-contents__link toc-highlight">Server - Watchdog</a></li><li><a href="#server---server" class="table-of-contents__link toc-highlight">Server - Server</a></li><li><a href="#web-ui--reverse-proxy" class="table-of-contents__link toc-highlight">Web UI &amp; Reverse Proxy</a></li><li><a href="#agent" class="table-of-contents__link toc-highlight">Agent</a></li></ul></li><li><a href="#the-first-job" class="table-of-contents__link toc-highlight">The First Job</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation/">Installation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussion Group<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Business</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/contact">Contact</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy Policy</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 <a href="mailto:mike@kraken.ci">Michal Nowikowski</a>. Built with Docusaurus. Icons made by <a href="https://www.flaticon.com/authors/freepik">Freepik</a> from <a href="https://www.flaticon.com">flaticon</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.34bc126b.js"></script>
<script src="/assets/js/main.9f9a3be8.js"></script>
</body>
</html>