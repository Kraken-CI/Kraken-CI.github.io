<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-autoscale-in-cloud" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Autoscale in Cloud | Kraken CI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kraken.ci/docs/autoscale-in-cloud"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Autoscale in Cloud | Kraken CI"><meta data-rh="true" name="description" content="Kraken CI allows for creating executing machines dynamically in the"><meta data-rh="true" property="og:description" content="Kraken CI allows for creating executing machines dynamically in the"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kraken.ci/docs/autoscale-in-cloud"><link data-rh="true" rel="alternate" href="https://kraken.ci/docs/autoscale-in-cloud" hreflang="en"><link data-rh="true" rel="alternate" href="https://kraken.ci/docs/autoscale-in-cloud" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YHIPSVOLK3-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Autoscale in Cloud","item":"https://kraken.ci/docs/autoscale-in-cloud"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kraken CI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kraken CI Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-152860048-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-152860048-1",{anonymize_ip:!0}),gtag("config","G-XH68RHQVEL",{anonymize_ip:!0})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Kraken CI" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.f56f6407.css">
<script src="/assets/js/runtime~main.be58412f.js" defer="defer"></script>
<script src="/assets/js/main.c0a02706.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-big2.svg" alt="Kraken Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kraken CI</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="http://lab.kraken.ci" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Demo<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/docs/quick-start">Quick Start</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/contrib-kraken">Contributing</a></li><li><a href="https://discord.gg/jUvSZ4S5m3" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord Server<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://github.com/Kraken-CI/kraken/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussions<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="dropdown__link">Google Discussion Group<svg width="12" height="12" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/sponsors/godfryd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-sponsor-item">Sponsor Us<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/support">Support</a><a class="navbar__item navbar__link" href="/contact">Contact</a><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/Kraken-CI/kraken/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Download<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/"><span title="Introduction" class="categoryLinkLabel_W154">Introduction</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/proj-branches"><span title="Usage" class="categoryLinkLabel_W154">Usage</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/proj-branches"><span title="Projects and Branches" class="linkLabel_WmDU">Projects and Branches</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/stages"><span title="Stages in a Branch" class="linkLabel_WmDU">Stages in a Branch</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema"><span title="Workflow Schema" class="linkLabel_WmDU">Workflow Schema</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema-data"><span title="Data in Schema" class="linkLabel_WmDU">Data in Schema</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/env-vars"><span title="Environment Variables" class="linkLabel_WmDU">Environment Variables</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/secrets"><span title="Secrets" class="linkLabel_WmDU">Secrets</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/docker-executor"><span title="Docker Executor" class="linkLabel_WmDU">Docker Executor</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/lxd-executor"><span title="LXD Executor" class="linkLabel_WmDU">LXD Executor</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notifications"><span title="Notifications" class="linkLabel_WmDU">Notifications</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/webhooks"><span title="Webhooks" class="linkLabel_WmDU">Webhooks</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/autoscale-in-cloud"><span title="Autoscale in Cloud" class="linkLabel_WmDU">Autoscale in Cloud</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/test-results-basics"><span title="Test Results" class="categoryLinkLabel_W154">Test Results</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tools"><span title="Tools" class="linkLabel_WmDU">Tools</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/kkci"><span title="Kraken Client Tool" class="linkLabel_WmDU">Kraken Client Tool</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/migration"><span title="Migration" class="linkLabel_WmDU">Migration</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/tf-junit"><span title="Testing Frameworks" class="categoryLinkLabel_W154">Testing Frameworks</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/agents"><span title="Administration" class="categoryLinkLabel_W154">Administration</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/guide-intro"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/others"><span title="Competition" class="categoryLinkLabel_W154">Competition</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/contrib-kraken"><span title="Contributing" class="categoryLinkLabel_W154">Contributing</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/schema-ref"><span title="Reference" class="categoryLinkLabel_W154">Reference</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Usage</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Autoscale in Cloud</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Autoscale in Cloud</h1></header><p>Kraken CI allows for creating executing machines dynamically in the
cloud when they are needed. They can be either virtual machines or
containers. When new jobs are triggered and there are no agents
available for them, new machines with Kraken agents are
spawned. The configuration of the way of spawning new machines is
located in agent groups.</p>
<p>Currently, Kraken CI autoscaling is supporting:</p>
<ul>
<li class="">AWS EC2 virtual machines</li>
<li class="">AWS ECS containers</li>
<li class="">Azure virtual machines</li>
<li class="">Kubernetes</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="preparing-cloud-environment">Preparing Cloud Environment<a href="#preparing-cloud-environment" class="hash-link" aria-label="Direct link to Preparing Cloud Environment" title="Direct link to Preparing Cloud Environment" translate="no">​</a></h2>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AWS EC2</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">AWS ECS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Kubernetes</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>In the case of AWS EC2, it is required to assign proper permissions to the
accessing user so that Kraken can create or destroy EC2
instances. The list of all requires permissions looks as follows:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:AuthorizeSecurityGroupIngress&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:CreateKeyPair&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:CreateSecurityGroup&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:CreateTags&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DeleteKeyPair&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeInstances&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeInstanceStatus&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeInstanceTypeOfferings&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeRegions&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeSecurityGroups&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeVpcs&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:RunInstances&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:TerminateInstances&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: &quot;*&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>In the case of AWS ECS, it is required to assign proper permissions to
the accessing user so that Kraken can create or destroy ECS
tasks. The list of all requires permissions looks as follows:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Statement&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: [</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ec2:DescribeNetworkInterfaces&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ecs:RunTask&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ecs:StopTask&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ecs:DescribeTasks&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;ecs:ListTaskDefinitions&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: &quot;*&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Sid&quot;: &quot;VisualEditor1&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Action&quot;: &quot;iam:PassRole&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;Resource&quot;: &quot;arn:aws:iam::*:role/ecsTaskExecutionRole&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>For Kubernetes, there are two accessing variants: Kraken CI is
installed inside Kubernetes cluster or outside. In both cases, a proper
access must be configured. When Kraken is installed inside a
Kubernetes cluster then this is made using Helm chart and it also sets
service account and proper permissions. When Kraken CI sits outside of
Kubernetes cluster, then the service account and permissions must be
configured in the following way.</p><p>The content:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Namespace</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ServiceAccount</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kraken</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterRole</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kraken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">rules</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">apiGroups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;nodes&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;services&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pods&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;endpoints&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;namespaces&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">verbs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;get&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;list&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;watch&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">apiGroups</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">resources</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pods&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">verbs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;create&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;delete&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io/v1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterRoleBinding</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kraken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">crb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">roleRef</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterRole</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kraken</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">role</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">apiGroup</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> rbac.authorization.k8s.io</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">subjects</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ServiceAccount</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kraken</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &lt;namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre></div></div><p>should be copied and pasted to <code>kraken-serviceaccount.yaml</code> file or
downloaded from <a href="/assets/files/kraken-serviceaccount-bd8f51df760fdd9340742705154f3f28.yaml" target="_blank" class="">here</a>. Before creating
the resources, set your namespace by replacing all occurrences of
<code>&lt;namespace&gt;</code> with e.g. <code>kraken</code>.</p><p>And then create these resources using <code>kubectl</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f kraken-serviceaccount.yaml</span><br></span></code></pre></div></div><p>This will create:</p><ul>
<li class="">an indicated namespace (e.g. <code>kraken</code>),</li>
<li class="">a service account <code>kraken</code>,</li>
<li class="">a cluster role <code>kraken-role</code> that allows browsing nodes, services,
pods, endpoints and namespaces, and creating and deleting pods,</li>
<li class="">cluster role binding <code>kraken-crb</code> that assigns <code>kraken-role</code> role to <code>kraken</code>
service account</li>
</ul><p>Service account&#x27;s token will be used in the next steps.</p></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="global-cloud-settings">Global Cloud Settings<a href="#global-cloud-settings" class="hash-link" aria-label="Direct link to Global Cloud Settings" title="Direct link to Global Cloud Settings" translate="no">​</a></h2>
<p>First, global settings must be set to allow access to a given cloud
provider. In Web UI, on Kraken -&gt; Settings page, in Cloud tab,
there is a form for collecting credentials to cloud providers:</p>
<a href="/img/screen-settings-cloud.png" target="blank"><img src="/img/screen-settings-cloud.png" style="box-shadow:0 10px 10px 5px #777;margin-bottom:30px"></a>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AWS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Azure</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Kubernetes</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>In the case of AWS, <code>Access Key</code> and <code>Secret Access Key</code> are required.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>When Microsoft Azure is used, then there are required <code>Subscription ID</code>,
<code>Tenant ID</code>, <code>Client ID</code> and <code>Client Secret</code>.</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>When Kraken is installed inside Kubernetes cluster, then only setting
<code>Namespace</code> field is required, <code>API Server URL</code> must be empty.</p><p>When Kraken is running outside of Kubernetes cluster then all fields
are required: <code>API Server URL</code>, <code>Namespace</code> and <code>Token</code>. <code>Namespace</code>
and <code>Token</code> were created in previous steps. The following commands will
reveal the token.</p><p>First, check the definition of <code>kraken</code> service account:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get serviceaccounts/kraken -n &lt;namespace&gt; -o yaml</span><br></span></code></pre></div></div><p>This should display a list of secrets at the bottom. The token should
be stored in a secret with a name in the form <code>kraken-token-XXXXX</code>
like e.g. <code>kraken-token-5fvcb</code>.</p><p>Now retrieve the token value:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get secret kraken-token-XXXXX -n &lt;namespace&gt; -o yaml</span><br></span></code></pre></div></div><p>The value should be under the token field, and it should be pretty
long. It is encoded using base64, and in this form, it should be copied
&amp; pasted to Kraken CI cloud settings (no decoding is required).</p></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="preparing-vm-image">Preparing VM Image<a href="#preparing-vm-image" class="hash-link" aria-label="Direct link to Preparing VM Image" title="Direct link to Preparing VM Image" translate="no">​</a></h2>
<p>In the case of VM environments, an operating system image needs to be
prepared. For example, in the case of AWS EC2, this image is called
AMI (Amazon Machine Image). There are certain requirements that this
image needs to meet in order to run a Kraken Agent. It should have
Python and Git preinstalled. Additionally, the generated image should
be capable of running a <code>user data</code> script during the initial
boot. This script is used to install the Kraken Agent and your own
init script (which can be passed via Kraken).</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AWS EC2</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>This is an example Packer script for preparing AMI with Ubuntu:</p><p><a href="https://github.com/Kraken-CI/kraken/blob/master/base-images/aws-ec2/aws-ubuntu.pkr.hcl" target="_blank" rel="noopener noreferrer" class="">https://github.com/Kraken-CI/kraken/blob/master/base-images/aws-ec2/aws-ubuntu.pkr.hcl</a></p><p>And here, you can find an example script for Ansible that prepares an AWS
AMI image for Windows with all the dependencies included:</p><p><a href="https://github.com/Kraken-CI/kraken/tree/master/base-images/aws-ec2-win-ansible" target="_blank" rel="noopener noreferrer" class="">https://github.com/Kraken-CI/kraken/tree/master/base-images/aws-ec2-win-ansible</a></p></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="configuration-in-agents-groups">Configuration in Agents Groups<a href="#configuration-in-agents-groups" class="hash-link" aria-label="Direct link to Configuration in Agents Groups" title="Direct link to Configuration in Agents Groups" translate="no">​</a></h2>
<p>Having set credentials to cloud providers, it is possible now to
configure the aspects of spawning new machines. This can be done on Kraken
-&gt; Agents -&gt; Groups page.  When a particular group is selected, then
its details will be presented on a separate tab. On this tab, there is
a section <code>Agents Deployment</code>. So the deployment can be manual
(default) or automated to the particular cloud provider.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AWS EC2</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">AWS ECS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Azure VM</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Kubernetes</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>In the case of <code>AWS EC2</code>, jobs are executed in AWS EC2 VMs. There are
the following options that can be set:</p><a href="/img/screen-agents-groups-cloud-aws.png" target="blank"><img src="/img/screen-agents-groups-cloud-aws.png" style="box-shadow:0 10px 10px 5px #777;margin-bottom:30px"></a><p>The meaning of the settings is as follows.</p><p>In <strong>General</strong> section:</p><p><strong>Region</strong> - AWS region where a machine will be spawned</p><p><strong>Instances Limit</strong> - maximum number of spawned machines at a time</p><p><strong>Default AMI Image</strong> - if AMI image is not provided in job definition
then this one is used</p><p>In <strong>VM Options</strong> section:</p><p><strong>Instance Type</strong> - EC2 instance type that should be used for spawned
machines, the full list is available on <a href="https://aws.amazon.com/ec2/instance-types/" target="_blank" rel="noopener noreferrer" class="">AWS web
page</a></p><p><strong>Spot Instance</strong> - indicates where Spot instance should be used (<a href="https://aws.amazon.com/ec2/spot/" target="_blank" rel="noopener noreferrer" class="">AWS
docs</a>)</p><p><strong>Monitoring</strong> - indicates if monitoring should be enabled (<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html" target="_blank" rel="noopener noreferrer" class="">AWS
docs</a>)</p><p><strong>CPU Credits Unlimited</strong> - this allows having more burst power, more
in <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-unlimited-mode.html" target="_blank" rel="noopener noreferrer" class="">AWS
docs</a></p><p><strong>Disk Size</strong> - the size of root disk, if 0 then default size is used otherwise provided number is counted in GB</p><p><strong>Init Script</strong> - a value of this text is passed as UserData to EC2
instance, generally, this is a script that is executing during the
first boot of instance (<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html" target="_blank" rel="noopener noreferrer" class="">AWS docs</a>)</p><p>In <strong>Destruction</strong> section:</p><p><strong>Destroy VM after N jobs</strong> - this indicates that the machine should
be destroyed (terminated) after it is used in N Kraken jobs, default
is 1, ie. machine is used once and then it is destroyed so each time
a new fresh machine is used for each job; 0 means that this
mechanism is disabled</p><p><strong>Destroy VM after N minutes of idle time</strong> - this indicates that the
machine should be destroyed (terminated) after it is not used in any
Kraken jobs for a given number of minutes, default is 10 minutes,
ie. a machine is destroyed if it sits idle for 10 minutes; 0 means
that this mechanism is disabled</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>In the case of <code>AWS ECS</code>, jobs are executed in containers in AWS ECS
cluster. There are the following options that can be set:</p><a href="/img/screen-agents-groups-cloud-aws-ecs.png" target="blank"><img src="/img/screen-agents-groups-cloud-aws-ecs.png" style="box-shadow:0 10px 10px 5px #777;margin-bottom:30px"></a><p>The meaning of the settings is as follows.</p><p>In <strong>General</strong> section:</p><p><strong>Region</strong> - AWS region where a machine will be spawned</p><p><strong>Instances Limit</strong> - maximum number of spawned machines at a time</p><p>In <strong>ECS Task Options</strong> section:</p><p><strong>Cluster</strong> - the name of ECS cluster</p><p><strong>Subnets</strong> - a list of subnets IDs separated by comma</p><p><strong>Security Group</strong> - ID of security group used for spawned tasks and their containers</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>In the case of <code>Azure VM</code>, jobs are executed in virtual machines, in
Microsoft Azure VMs. There are the following options that can be set:</p><a href="/img/screen-agents-groups-cloud-azure-vm.png" target="blank"><img src="/img/screen-agents-groups-cloud-azure-vm.png" style="box-shadow:0 10px 10px 5px #777;margin-bottom:30px"></a><p>The meaning of the settings is as follows.</p><p>In <strong>General</strong> section:</p><p><strong>Location</strong> - Azure location (region) where a machine will be spawned</p><p><strong>Instances Limit</strong> - maximum number of spawned machines at a time</p><p><strong>Default Image</strong> - if image is not provided in job definition
then this one is used; the expected format is: publisher:offer:sku<!-- -->:version<!-- -->,
e.g.: Canonical:0001-com-ubuntu-server-focal:20_04-lts:20.04.202109080</p><p>In <strong>VM Options</strong> section:</p><p><strong>VM Size</strong> - Azure VM size that should be used for spawned
machines; more about VM sizes can be found on <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/sizes" target="_blank" rel="noopener noreferrer" class="">Azure web
page</a></p><p><strong>Init Script</strong> - a value of this text is passed as user_data to VM
instance, generally, this is a script that is executing during the
first boot of instance</p><p>In <strong>Destruction</strong> section:</p><p><strong>Destroy VM after N jobs</strong> - this indicates that the machine should
be destroyed (terminated) after it is used in N Kraken jobs, default
is 1, ie. machine is used once and then it is destroyed so each time
a new fresh machine is used for each job; 0 means that this
mechanism is disabled</p><p><strong>Destroy VM after N minutes of idle time</strong> - this indicates that the
machine should be destroyed (terminated) after it is not used in any
Kraken jobs for a given number of minutes, default is 10 minutes,
ie. a machine is destroyed if it sits idle for 10 minutes; 0 means
that this mechanism is disabled</p></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>In the case of <code>Kubernetes</code>, jobs are executed in containers in a
Kubernetes cluster. Kubernetes cluster can be self-hosted or hosted in
a public cloud like AWS EKS. There are the following options that can
be set:</p><a href="/img/screen-agents-groups-cloud-kubernetes.png" target="blank"><img src="/img/screen-agents-groups-cloud-kubernetes.png" style="box-shadow:0 10px 10px 5px #777;margin-bottom:30px"></a><p>The meaning of the settings is as follows.</p><p>In <strong>General</strong> section:</p><p><strong>Instances Limit</strong> - maximum number of spawned containers at a time</p></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage" translate="no">​</a></h2>
<p>Now when a job is assigned to an agents group with configured Agents
Deployment then a new machine will be spawned for that job if there
are no available agents.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/kraken-ci/website/edit/master/docs/autoscale-in-cloud.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/webhooks"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Webhooks</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/test-results-basics"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Basics</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preparing-cloud-environment" class="table-of-contents__link toc-highlight">Preparing Cloud Environment</a></li><li><a href="#global-cloud-settings" class="table-of-contents__link toc-highlight">Global Cloud Settings</a></li><li><a href="#preparing-vm-image" class="table-of-contents__link toc-highlight">Preparing VM Image</a></li><li><a href="#configuration-in-agents-groups" class="table-of-contents__link toc-highlight">Configuration in Agents Groups</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/proj-branches/">Usage</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/agents/">Administration</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/guide-intro/">Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/schema-ref/">Reference</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/contrib-kraken">Contributing</a></li><li class="footer__item"><a href="https://discord.gg/bEw7Pemn" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord Server<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Kraken-CI/kraken/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://groups.google.com/g/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Discussion Group<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Business</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/support">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/contact">Contact</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy">Privacy Policy</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kraken-ci/kraken" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/kraken-ci" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 <a href="mailto:mike@kraken.ci">Michal Nowikowski</a>. Built with Docusaurus. Icons made by <a href="https://www.flaticon.com/authors/freepik">Freepik</a> from <a href="https://www.flaticon.com">flaticon</a></div></div></div></footer></div>
</body>
</html>